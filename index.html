<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Andromeda Ads â€” Meta AI Automation</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&display=swap" rel="stylesheet" />
</head>

<body>
  <div id="app">

    <!-- Sidebar -->
    <aside class="sidebar glass">
      <div class="logo">
        <span class="logo-icon">ğŸŒŒ</span>
        <div>
          <h1>Andromeda <span>Ads</span></h1>
          <p class="logo-sub">Meta AI Automation</p>
        </div>
      </div>

      <nav class="sidebar-nav">
        <button class="nav-btn active" data-view="setup">
          <span class="nav-icon">âš™ï¸</span>
          <span>ConfiguraciÃ³n</span>
          <span class="nav-badge" id="badgeSetup"></span>
        </button>
        <button class="nav-btn" data-view="briefing">
          <span class="nav-icon">ğŸ“‹</span>
          <span>Briefing de Marca</span>
          <span class="nav-badge" id="badgeBriefing"></span>
        </button>
        <button class="nav-btn" data-view="concepts">
          <span class="nav-icon">ğŸ’¡</span>
          <span>Conceptos y Creativos</span>
          <span class="nav-badge" id="badgeConcepts"></span>
        </button>
        <button class="nav-btn" data-view="campaign">
          <span class="nav-icon">ğŸš€</span>
          <span>Lanzar CampaÃ±a</span>
          <span class="nav-badge" id="badgeCampaign"></span>
        </button>
        <button class="nav-btn" data-view="dashboard">
          <span class="nav-icon">ğŸ“Š</span>
          <span>Dashboard</span>
          <span class="nav-badge" id="badgeDashboard"></span>
        </button>
      </nav>

      <div class="sidebar-footer">
        <div class="agent-status">
          <div class="agent-dot" id="agentDot"></div>
          <span id="agentLabel">Agentes listos</span>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="workspace">

      <!-- â”€â”€ VIEW: SETUP â”€â”€ -->
      <section id="viewSetup" class="view active">
        <div class="view-header">
          <h2>ğŸ”Œ Plataformas de Publicidad</h2>
          <p class="view-sub">Conecta tus cuentas publicitarias para activar la automatizaciÃ³n con IA</p>
        </div>

        <!-- Platform connection cards -->
        <div class="platform-cards">

          <!-- Meta -->
          <div class="platform-card" id="platformMeta" data-platform="meta">
            <div class="platform-card-top">
              <div class="platform-logo meta-logo">
                <svg viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" width="28" height="28">
                  <path d="M18 3C9.716 3 3 9.716 3 18s6.716 15 15 15 15-6.716 15-15S26.284 3 18 3Z" fill="url(#mg)" />
                  <path
                    d="M13.5 14.5c0-1.1.45-2 1.2-2 .66 0 1.05.38 1.8 1.7l3 5.5 3-5.5c.75-1.32 1.14-1.7 1.8-1.7.75 0 1.2.9 1.2 2V22h-2v-5.5L21 21h-1.5l-1.5-4.5V22h-2v-5.5L14.5 21H13v-6.5Z"
                    fill="#fff" />
                  <defs>
                    <linearGradient id="mg" x1="3" y1="3" x2="33" y2="33" gradientUnits="userSpaceOnUse">
                      <stop stop-color="#1877F2" />
                      <stop offset="1" stop-color="#a855f7" />
                    </linearGradient>
                  </defs>
                </svg>
              </div>
              <div class="platform-info">
                <span class="platform-name">Meta Ads</span>
                <span class="platform-channels">Facebook Â· Instagram Â· Reels</span>
              </div>
              <div class="platform-status-badge" id="metaBadge">
                <span class="status-dot"></span>
                <span class="status-text">Sin conectar</span>
              </div>
            </div>
            <p class="platform-desc">Crea y gestiona campaÃ±as de conversiÃ³n en Facebook e Instagram con optimizaciÃ³n
              automÃ¡tica por IA.</p>
            <button class="btn btn-platform-connect" id="btnOpenMeta">Configurar â†’</button>
          </div>

          <!-- Google Ads -->
          <div class="platform-card" id="platformGoogle" data-platform="google">
            <div class="platform-card-top">
              <div class="platform-logo google-logo">
                <svg viewBox="0 0 28 28" width="28" height="28" xmlns="http://www.w3.org/2000/svg">
                  <text y="22" font-size="24" font-family="Arial" font-weight="bold">
                    <tspan fill="#4285F4">G</tspan>
                  </text>
                </svg>
              </div>
              <div class="platform-info">
                <span class="platform-name">Google Ads</span>
                <span class="platform-channels">Search Â· Shopping Â· YouTube</span>
              </div>
              <div class="platform-status-badge" id="googleBadge">
                <span class="status-dot"></span>
                <span class="status-text">Sin conectar</span>
              </div>
            </div>
            <p class="platform-desc">CampaÃ±as de bÃºsqueda y Shopping para capturar intenciÃ³n de compra activa en Google
              y YouTube.</p>
            <button class="btn btn-platform-google" id="btnOpenGoogle">Configurar â†’</button>
          </div>

          <!-- TikTok -->
          <div class="platform-card" id="platformTikTok" data-platform="tiktok">
            <div class="platform-card-top">
              <div class="platform-logo tiktok-logo">
                <svg viewBox="0 0 28 28" width="28" height="28" xmlns="http://www.w3.org/2000/svg">
                  <text y="22" font-size="22" font-family="Arial" font-weight="bold" fill="#FE2C55">â™ª</text>
                </svg>
              </div>
              <div class="platform-info">
                <span class="platform-name">TikTok Ads</span>
                <span class="platform-channels">In-Feed Â· TopView Â· Spark</span>
              </div>
              <div class="platform-status-badge" id="tiktokBadge">
                <span class="status-dot"></span>
                <span class="status-text">Sin conectar</span>
              </div>
            </div>
            <p class="platform-desc">Anuncios de imagen y vÃ­deo en TikTok para audiencias jÃ³venes con alto potencial de
              descubrimiento.</p>
            <button class="btn btn-platform-tiktok" id="btnOpenTikTok">Configurar â†’</button>
          </div>

        </div>

        <!-- Meta credentials panel (expandable) -->
        <div class="platform-form-panel glass" id="metaFormPanel">
          <div class="panel-header">
            <div class="panel-title-row">
              <span class="panel-platform-icon">ğŸ“˜</span>
              <h3>Conectar Meta Ads</h3>
            </div>
            <button class="btn btn-ghost btn-sm" id="btnCloseMetaPanel">âœ• Cerrar</button>
          </div>

          <div class="panel-body">
            <div class="panel-form-col">
              <div class="form-group">
                <label>Access Token (token de larga duraciÃ³n)</label>
                <input type="password" id="metaToken" placeholder="EAAxxxxxxxxx..." />
              </div>
              <div class="form-group">
                <label>Ad Account ID</label>
                <input type="text" id="metaAdAccount" placeholder="act_123456789" />
              </div>
              <div class="form-group">
                <label>Facebook Page ID</label>
                <input type="text" id="metaPageId" placeholder="123456789" />
              </div>
              <div id="metaStatus" class="status-msg hidden"></div>
              <button class="btn btn-primary" id="btnVerifyMeta">ğŸ”— Verificar ConexiÃ³n</button>
            </div>

            <div class="panel-guide-col">
              <h4 class="card-title">ğŸ“– CÃ³mo obtener las credenciales</h4>
              <ol class="setup-steps">
                <li>
                  <strong>Crea una Meta App</strong>
                  <p>Ve a <a href="https://developers.facebook.com/apps/create" target="_blank"
                      rel="noopener">developers.facebook.com</a> â†’ Crear App â†’ Tipo: <em>Business</em></p>
                </li>
                <li>
                  <strong>AÃ±ade Marketing API</strong>
                  <p>En tu app â†’ Productos â†’ AÃ±adir Marketing API</p>
                </li>
                <li>
                  <strong>ObtÃ©n permisos</strong>
                  <p>Necesitas: <code>ads_management</code>, <code>ads_read</code>, <code>pages_read_engagement</code>
                  </p>
                </li>
                <li>
                  <strong>Genera tu Access Token</strong>
                  <p><a href="https://developers.facebook.com/tools/explorer" target="_blank" rel="noopener">Graph API
                      Explorer</a> â†’ selecciona tu app â†’ genera token de 60 dÃ­as</p>
                </li>
                <li>
                  <strong>Ad Account ID</strong>
                  <p><a href="https://business.facebook.com" target="_blank" rel="noopener">business.facebook.com</a> â†’
                    Cuentas publicitarias â†’ copia <code>act_XXXXX</code></p>
                </li>
              </ol>
            </div>
          </div>
        </div>

        <!-- Google credentials panel -->
        <div class="platform-form-panel glass" id="googleFormPanel">
          <div class="panel-header">
            <div class="panel-title-row">
              <span class="panel-platform-icon">ğŸ”µ</span>
              <h3>Conectar Google Ads</h3>
            </div>
            <button class="btn btn-ghost btn-sm" id="btnCloseGooglePanel">âœ• Cerrar</button>
          </div>
          <div class="panel-body">
            <div class="panel-form-col">
              <div class="form-group">
                <label>Customer ID</label>
                <input type="text" id="googleCustomerId" placeholder="123-456-7890" />
              </div>
              <div class="form-group">
                <label>Developer Token</label>
                <input type="password" id="googleDevToken" placeholder="tu_developer_token" />
              </div>
              <div class="form-group">
                <label>OAuth2 Access Token</label>
                <input type="password" id="googleAccessToken" placeholder="ya29.xxxxxxxxx" />
              </div>
              <div id="googleStatus" class="status-msg hidden"></div>
              <button class="btn btn-primary" id="btnVerifyGoogle">ğŸ”— Verificar ConexiÃ³n</button>
            </div>
            <div class="panel-guide-col">
              <h4 class="card-title">ğŸ“– CÃ³mo obtener las credenciales</h4>
              <ol class="setup-steps">
                <li>
                  <strong>Activa la Google Ads API</strong>
                  <p>Ve a <a href="https://developers.google.com/google-ads/api/docs/get-started/introduction"
                      target="_blank" rel="noopener">Google Ads API</a> â†’ solicita acceso â†’ obtendrÃ¡s un Developer Token
                    en tu cuenta MCC</p>
                </li>
                <li>
                  <strong>Customer ID</strong>
                  <p>Tu cuenta de Google Ads â†’ menÃº superior â†’ nÃºmero con formato <code>123-456-7890</code></p>
                </li>
                <li>
                  <strong>Access Token (OAuth2)</strong>
                  <p>Usa <a href="https://developers.google.com/oauthplayground" target="_blank" rel="noopener">OAuth
                      Playground</a> â†’ scope: <code>https://www.googleapis.com/auth/adwords</code> â†’ genera token</p>
                </li>
              </ol>
            </div>
          </div>
        </div>

        <!-- TikTok credentials panel -->
        <div class="platform-form-panel glass" id="tiktokFormPanel">
          <div class="panel-header">
            <div class="panel-title-row">
              <span class="panel-platform-icon">ğŸµ</span>
              <h3>Conectar TikTok Ads</h3>
            </div>
            <button class="btn btn-ghost btn-sm" id="btnCloseTikTokPanel">âœ• Cerrar</button>
          </div>
          <div class="panel-body">
            <div class="panel-form-col">
              <div class="form-group">
                <label>Access Token</label>
                <input type="password" id="tiktokAccessToken" placeholder="tu_access_token_tiktok" />
              </div>
              <div class="form-group">
                <label>Advertiser ID</label>
                <input type="text" id="tiktokAdvertiserId" placeholder="7000000000000000000" />
              </div>
              <div id="tiktokStatus" class="status-msg hidden"></div>
              <button class="btn btn-primary" id="btnVerifyTikTok">ğŸ”— Verificar ConexiÃ³n</button>
            </div>
            <div class="panel-guide-col">
              <h4 class="card-title">ğŸ“– CÃ³mo obtener las credenciales</h4>
              <ol class="setup-steps">
                <li>
                  <strong>Crea una app en TikTok for Business</strong>
                  <p>Ve a <a href="https://ads.tiktok.com/marketing_api/apps/" target="_blank" rel="noopener">TikTok
                      Marketing API</a> â†’ Crear App â†’ tipo: <em>Web</em></p>
                </li>
                <li>
                  <strong>ObtÃ©n el Access Token</strong>
                  <p>En tu app â†’ Authorization â†’ genera un token de larga duraciÃ³n con permisos de
                    <code>Ads Management</code>
                  </p>
                </li>
                <li>
                  <strong>Advertiser ID</strong>
                  <p><a href="https://ads.tiktok.com" target="_blank" rel="noopener">ads.tiktok.com</a> â†’ tu cuenta â†’ el
                    nÃºmero de 19 dÃ­gitos en la URL</p>
                </li>
              </ol>
            </div>
          </div>
        </div>

        <!-- â”€â”€ AI Provider API Keys â”€â”€ -->
        <div class="card glass ai-keys-card">
          <h3 class="card-title">ğŸ¤– Tu IA personal â€” Multi-proveedor</h3>
          <div class="byok-notice">
            <span class="byok-icon">ğŸ”’</span>
            <div>
              <strong>Tus claves, tu control</strong>
              <p>Cada usuario usa su propia clave de IA. Se guardan <strong>solo en tu navegador</strong> y se envÃ­an directamente al proveedor. Andromeda Ads nunca las almacena.</p>
            </div>
          </div>
          <p style="font-size:12px;color:var(--text-dim);margin:0 0 16px">Configura al menos uno. Si tienes ambos, Anthropic tiene prioridad para texto e imÃ¡genes con OpenAI.</p>
          <div class="ai-keys-grid">

            <!-- Anthropic -->
            <div class="ai-key-item">
              <div class="ai-key-header">
                <span class="ai-key-icon">âœ¦</span>
                <div class="ai-key-info">
                  <span class="ai-key-name">Anthropic Â· Claude</span>
                  <span class="ai-key-uses">Conceptos Â· Chat Jarvi Â· AnÃ¡lisis Â· OptimizaciÃ³n</span>
                </div>
                <span class="ai-key-badge" id="claudeKeyBadge">Sin clave</span>
              </div>
              <div class="ai-key-row">
                <input type="password" id="anthropicKeyInput" placeholder="sk-ant-api03-..." autocomplete="off" />
                <a href="https://console.anthropic.com/settings/keys" target="_blank" class="ai-key-link">Obtener â†’</a>
              </div>
            </div>

            <!-- OpenAI -->
            <div class="ai-key-item">
              <div class="ai-key-header">
                <span class="ai-key-icon">âš¡</span>
                <div class="ai-key-info">
                  <span class="ai-key-name">OpenAI Â· GPT-4o</span>
                  <span class="ai-key-uses">Fallback de texto Â· ImÃ¡genes (gpt-image-1)</span>
                </div>
                <span class="ai-key-badge" id="openaiKeyBadge">Sin clave</span>
              </div>
              <div class="ai-key-row">
                <input type="password" id="openaiKeyInput" placeholder="sk-proj-..." autocomplete="off" />
                <a href="https://platform.openai.com/api-keys" target="_blank" class="ai-key-link">Obtener â†’</a>
              </div>
            </div>

          </div>
          <div class="ai-keys-footer">
            <button class="btn btn-primary" id="btnSaveApiKeys">ğŸ’¾ Guardar claves en este navegador</button>
            <div id="apiKeysStatus" class="status-msg hidden"></div>
          </div>
        </div>

        <!-- Shopify Brand Import Banner -->
        <div class="shopify-import-card glass" id="shopifyImportCard">
          <div class="shopify-import-left">
            <span class="shopify-icon">ğŸ›ï¸</span>
            <div>
              <strong>Importar marca desde Shopify</strong>
              <p>Conecta tu tienda y la IA leerÃ¡ tus productos, colecciones y copy para rellenar el briefing
                automÃ¡ticamente.</p>
            </div>
          </div>
          <div class="shopify-import-right">
            <input type="text" id="shopifyShopUrl" placeholder="tu-tienda.myshopify.com" />
            <input type="password" id="shopifyTokenInput" placeholder="shpat_xxxxxxxx" />
            <button class="btn btn-shopify" id="btnImportFromShopify">âœ¨ Analizar tienda con IA</button>
          </div>
          <div id="shopifyImportStatus" class="status-msg hidden" style="grid-column:1/-1"></div>
        </div>

      </section>

      <!-- â”€â”€ VIEW: BRIEFING â”€â”€ -->
      <section id="viewBriefing" class="view">
        <div class="view-header">
          <h2>ğŸ“‹ Briefing de Marca</h2>
          <p class="view-sub">Responde 5 preguntas para que los agentes IA entiendan tu marca y generen anuncios
            efectivos</p>
        </div>

        <!-- Product Focus picker -->
        <div class="card glass product-focus-card">
          <div class="product-focus-header">
            <div>
              <h3 class="card-title" style="margin-bottom:4px">ğŸ¯ Producto especÃ­fico <span
                  class="label-hint">(opcional)</span></h3>
              <p class="product-focus-hint">Enfoca todos los conceptos y creativos en un solo producto. Si lo dejas
                vacÃ­o, cubrirÃ¡ toda la marca.</p>
            </div>
            <button class="btn btn-secondary btn-sm" id="btnLoadProducts">ğŸ›ï¸ Cargar desde Shopify</button>
          </div>

          <div id="productPickerWrap" class="hidden">
            <div class="product-search-box">
              <span class="product-search-icon">ğŸ”</span>
              <input type="text" id="productSearchInput" placeholder="Buscar producto por nombre..."
                autocomplete="off" />
              <button class="btn btn-ghost btn-sm" id="btnClearSearch" title="Limpiar bÃºsqueda">âœ•</button>
            </div>
            <div id="productResultsList" class="product-results-list"></div>
          </div>

          <div id="selectedProductPreview" class="hidden product-preview-row">
            <img id="selectedProductImg" class="product-preview-img" alt="" />
            <div class="product-preview-info">
              <strong id="selectedProductName"></strong>
              <span id="selectedProductPrice" class="product-preview-price"></span>
              <p id="selectedProductDesc" class="product-preview-desc"></p>
            </div>
            <button class="btn btn-ghost btn-sm" id="btnClearProduct" style="align-self:flex-start">âœ•</button>
          </div>

          <div id="productPickerStatus" class="status-msg hidden"></div>
        </div>

        <div class="card glass briefing-card">
          <div class="briefing-form">
            <div class="form-group">
              <label>1. Â¿QuÃ© vendes exactamente? <span class="label-hint">(producto estrella, precio, materiales,
                  colecciones)</span></label>
              <textarea id="b1" rows="3"
                placeholder="Ej: Ropa femenina de tallas grandes, colecciÃ³n primavera-verano 2025. Precio medio: 35â‚¬. Tejidos naturales y sostenibles..."></textarea>
            </div>
            <div class="form-group">
              <label>2. Â¿QuiÃ©n es tu cliente ideal? <span class="label-hint">(edad, gÃ©nero, estilo de vida,
                  valores)</span></label>
              <textarea id="b2" rows="3"
                placeholder="Ej: Mujeres de 25-45 aÃ±os que valoran la moda sostenible, buscan looks modernos para el trabajo y el dÃ­a a dÃ­a..."></textarea>
            </div>
            <div class="form-group">
              <label>3. Â¿CuÃ¡l es el mayor problema que resuelves? <span class="label-hint">(dolor del
                  cliente)</span></label>
              <textarea id="b3" rows="3"
                placeholder="Ej: Las mujeres de tallas grandes tienen dificultad para encontrar ropa estilosa que les quede bien y no sea cara..."></textarea>
            </div>
            <div class="form-group">
              <label>4. Â¿QuÃ© te diferencia de la competencia? <span class="label-hint">(propuesta de valor
                  Ãºnica)</span></label>
              <textarea id="b4" rows="3"
                placeholder="Ej: DiseÃ±os exclusivos hechos en EspaÃ±a, tallas del 36 al 56, envÃ­o gratis en 24h, devoluciÃ³n gratuita..."></textarea>
            </div>
            <div class="form-group">
              <label>5. Â¿CuÃ¡l es el tono de tu marca? <span class="label-hint">(elige uno o describe)</span></label>
              <div class="tone-grid" id="toneGrid">
                <button class="tone-btn" data-tone="elegante y sofisticada">âœ¨ Elegante</button>
                <button class="tone-btn" data-tone="casual y cercana">ğŸ˜Š Casual</button>
                <button class="tone-btn" data-tone="atrevida y provocadora">ğŸ”¥ Atrevida</button>
                <button class="tone-btn" data-tone="minimalista y clean">ğŸ¤ Minimalista</button>
                <button class="tone-btn" data-tone="divertida y jovial">ğŸ‰ Divertida</button>
                <button class="tone-btn" data-tone="empoderada y feminista">ğŸ’ª Empoderada</button>
              </div>
              <input type="hidden" id="b5" value="" />
            </div>
          </div>
          <div id="briefingStatus" class="status-msg hidden"></div>
          <button class="btn btn-primary btn-lg" id="btnGenerateConcepts">âœ¨ Generar 10 Conceptos con IA</button>
        </div>
      </section>

      <!-- â”€â”€ VIEW: CONCEPTS â”€â”€ -->
      <section id="viewConcepts" class="view">
        <div class="view-header">
          <h2>ğŸ’¡ Conceptos y Creativos</h2>
          <p class="view-sub">Selecciona los conceptos que quieres incluir en tu campaÃ±a y genera sus creativos</p>
        </div>

        <div class="concepts-toolbar">
          <span id="conceptsSelectedCount" class="badge-count">0 seleccionados</span>
          <button class="btn btn-secondary btn-sm" id="btnSelectAllConcepts">âœ“ Todos</button>
          <button class="btn btn-primary" id="btnGoToCampaign" disabled>ğŸš€ Configurar CampaÃ±a â†’</button>
        </div>

        <div id="conceptsGrid" class="concepts-grid">
          <!-- Concept cards injected here -->
        </div>

        <!-- Image generation modal -->
        <div id="creativeModal" class="modal hidden">
          <div class="modal-backdrop"></div>
          <div class="modal-box glass">
            <h3 id="modalTitle">Generar Creativo</h3>
            <div class="modal-tabs">
              <button class="modal-tab active" data-mode="generate">ğŸ¨ Desde cero</button>
              <button class="modal-tab" id="tabShopify" data-mode="shopify">ğŸ“¦ Foto del producto</button>
              <button class="modal-tab" data-mode="edit">ğŸ“¸ Mi foto</button>
              <button class="modal-tab" data-mode="manual">ğŸ–¼ï¸ Mi imagen</button>
            </div>

            <div id="modeGenerate" class="modal-mode">
              <p class="mode-hint">La IA generarÃ¡ una imagen de moda segÃºn el concepto del anuncio</p>
              <div class="form-group">
                <label>Estilo visual adicional (opcional)</label>
                <input type="text" id="genStyle" placeholder="Ej: fondo blanco, modelo morena, luz natural..." />
              </div>
            </div>

            <div id="modeShopify" class="modal-mode hidden">
              <p class="mode-hint">Elige una foto del producto seleccionado â€” la IA la convertirÃ¡ en anuncio manteniendo
                el producto idÃ©ntico</p>
              <div id="shopifyPhotosGrid" class="shopify-photos-grid"></div>
              <p id="shopifyPhotosEmpty" class="mode-hint hidden">No hay producto seleccionado o el producto no tiene
                imÃ¡genes.</p>
            </div>

            <div id="modeEdit" class="modal-mode hidden">
              <p class="mode-hint">Sube una foto de tu producto y la IA aÃ±adirÃ¡ texto y lo adaptarÃ¡ como anuncio</p>
              <div class="upload-area" id="photoUploadArea">
                <input type="file" id="photoFileInput" accept="image/*" class="hidden" />
                <span>ğŸ“ Arrastra o haz clic para subir foto</span>
              </div>
              <img id="photoPreview" class="photo-preview hidden" alt="preview" />
            </div>

            <div id="modeManual" class="modal-mode hidden">
              <p class="mode-hint">Usa tu propia imagen. Solo se generarÃ¡ el copy del anuncio.</p>
              <div class="upload-area" id="manualUploadArea">
                <input type="file" id="manualFileInput" accept="image/*" class="hidden" />
                <span>ğŸ“ Sube la imagen del anuncio</span>
              </div>
              <img id="manualPreview" class="photo-preview hidden" alt="preview" />
            </div>

            <div id="modalResult" class="modal-result hidden">
              <img id="generatedCreative" alt="Creative" />
              <a id="btnDownloadCreative" class="btn btn-secondary btn-sm" download="creative.png">â¬‡ Descargar</a>
            </div>

            <div id="modalStatus" class="status-msg hidden"></div>
            <div class="modal-actions">
              <button class="btn btn-primary" id="btnGenerateCreative">ğŸ¨ Generar</button>
              <button class="btn btn-ghost" id="btnCloseModal">Cerrar</button>
            </div>
          </div>
        </div>
      </section>

      <!-- â”€â”€ VIEW: CAMPAIGN â”€â”€ -->
      <section id="viewCampaign" class="view">
        <div class="view-header">
          <h2>ğŸš€ Configurar y Lanzar CampaÃ±a</h2>
          <p class="view-sub">Configura el presupuesto, la audiencia y lanza la campaÃ±a de microexperimentaciÃ³n</p>
        </div>

        <!-- Platform selector -->
        <div class="campaign-platform-tabs">
          <button class="camp-tab active" data-platform="meta">ğŸ“˜ Meta (Facebook/Instagram)</button>
          <button class="camp-tab" data-platform="google">ğŸ”µ Google Ads</button>
          <button class="camp-tab" data-platform="tiktok">ğŸµ TikTok Ads</button>
        </div>
        <input type="hidden" id="activePlatform" value="meta" />

        <div class="campaign-grid">
          <!-- Campaign Settings -->
          <div class="card glass">
            <h3 class="card-title">ğŸ“Œ ConfiguraciÃ³n de CampaÃ±a</h3>
            <div class="form-group">
              <label>Nombre de campaÃ±a <span class="req">*</span></label>
              <input type="text" id="campaignName" placeholder="Andromeda_Moda_Ene2025" />
              <span class="field-err-msg" id="errCampaignName">Campo obligatorio</span>
            </div>
            <div class="form-group">
              <label>Objetivo</label>
              <select id="campaignObjective">
                <option value="OUTCOME_TRAFFIC" selected>TrÃ¡fico al sitio web â†’ Compra (recomendado)</option>
                <option value="OUTCOME_SALES">Ventas con Pixel (requiere Meta Pixel instalado)</option>
              </select>
            </div>
            <div class="form-group">
              <label>Presupuesto diario por ad set</label>
              <div class="input-prefix">
                <span>$</span>
                <input type="number" id="dailyBudget" value="5" min="1" step="1" />
              </div>
              <span class="input-hint" id="budgetHint">$5/dÃ­a Ã— 7 dÃ­as = $35 total por concepto</span>
            </div>
            <div class="form-group">
              <label>DuraciÃ³n (dÃ­as)</label>
              <input type="number" id="campaignDuration" value="7" min="1" max="30" />
            </div>
            <div class="form-group">
              <label>URL de destino (tu tienda online) <span class="req">*</span></label>
              <input type="text" id="destinationUrl" placeholder="https://tu-tienda.com/collections/all" />
              <span class="field-err-msg" id="errDestinationUrl">Campo obligatorio</span>
            </div>
          </div>

          <!-- Audience Settings -->
          <div class="card glass">
            <h3 class="card-title">ğŸ¯ Audiencia</h3>
            <div class="form-group">
              <label>PaÃ­s(es) <span class="req">*</span></label>
              <input type="text" id="targetCountries" value="ES" placeholder="ES, MX, AR..." />
              <span class="field-err-msg" id="errTargetCountries">Campo obligatorio</span>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Edad mÃ­nima</label>
                <input type="number" id="ageMin" value="18" min="18" max="65" />
              </div>
              <div class="form-group">
                <label>Edad mÃ¡xima</label>
                <input type="number" id="ageMax" value="45" min="18" max="65" />
              </div>
            </div>
            <div class="form-group">
              <label>GÃ©nero</label>
              <select id="targetGender">
                <option value="all" selected>Todos</option>
                <option value="1">Hombres</option>
                <option value="2">Mujeres</option>
              </select>
            </div>
            <div class="form-group">
              <label>Intereses (separados por coma)</label>
              <input type="text" id="targetInterests" value="Moda, Ropa, Compras online, Instagram Fashion" />
            </div>
          </div>
        </div>

        <!-- Selected concepts summary -->
        <div class="card glass" id="selectedConceptsSummary">
          <h3 class="card-title">ğŸ’¡ Conceptos seleccionados (<span id="selectedCount">0</span>)</h3>
          <div id="selectedConceptsList" class="selected-list"></div>
        </div>

        <div id="campaignStatus" class="status-msg hidden"></div>
        <button class="btn btn-primary btn-lg btn-launch" id="btnLaunchCampaign">ğŸš€ Lanzar CampaÃ±a Ahora</button>
      </section>

      <!-- â”€â”€ VIEW: DASHBOARD â”€â”€ -->
      <section id="viewDashboard" class="view">
        <div class="view-header">
          <h2>ğŸ“Š Dashboard de Rendimiento</h2>
          <p class="view-sub">Seguimiento en tiempo real y optimizaciÃ³n automÃ¡tica con IA</p>
        </div>

        <!-- Campaign selector -->
        <div class="dashboard-toolbar">
          <select id="campaignSelector">
            <option value="">Selecciona una campaÃ±a...</option>
          </select>
          <button class="btn btn-secondary btn-sm" id="btnRefreshStats">â†º Actualizar</button>
          <button class="btn btn-primary" id="btnAnalyzeAI">ğŸ¤– Analizar con IA</button>
          <button class="btn btn-warning hidden" id="btnApplyOptimizations">âš¡ Aplicar Recomendaciones</button>
        </div>

        <!-- Pending image upload notice -->
        <div id="pendingImagesPanel" class="card glass pending-upload-panel hidden">
          <div class="pending-upload-inner">
            <span>âš ï¸ Esta campaÃ±a tiene <strong id="pendingCount">0</strong> imagen(es) generada(s) sin subir a
              Meta.</span>
            <button class="btn btn-primary btn-sm" id="btnUploadPending">ğŸ“¤ Subir imÃ¡genes ahora</button>
          </div>
        </div>

        <!-- KPI Cards -->
        <div class="kpi-grid" id="kpiGrid">
          <div class="kpi-card glass">
            <span class="kpi-label">Gasto Total</span>
            <span class="kpi-value" id="kpiSpend">â€”</span>
          </div>
          <div class="kpi-card glass">
            <span class="kpi-label">Impresiones</span>
            <span class="kpi-value" id="kpiImpressions">â€”</span>
          </div>
          <div class="kpi-card glass">
            <span class="kpi-label">Clics</span>
            <span class="kpi-value" id="kpiClicks">â€”</span>
          </div>
          <div class="kpi-card glass">
            <span class="kpi-label">CTR</span>
            <span class="kpi-value" id="kpiCtr">â€”</span>
          </div>
          <div class="kpi-card glass">
            <span class="kpi-label">CPM</span>
            <span class="kpi-value" id="kpiCpm">â€”</span>
          </div>
          <div class="kpi-card glass">
            <span class="kpi-label">Conversiones</span>
            <span class="kpi-value" id="kpiConversions">â€”</span>
          </div>
        </div>

        <!-- Ads performance table -->
        <div class="card glass">
          <h3 class="card-title">ğŸ“‹ Rendimiento por Anuncio</h3>
          <div class="table-wrap">
            <table id="adsTable">
              <thead>
                <tr>
                  <th>Anuncio / Concepto</th>
                  <th>Gasto</th>
                  <th>Impresiones</th>
                  <th>CTR</th>
                  <th>CPM</th>
                  <th>Conversiones</th>
                  <th>ROAS</th>
                  <th>Estado IA</th>
                </tr>
              </thead>
              <tbody id="adsTableBody">
                <tr>
                  <td colspan="8" class="table-empty">Selecciona una campaÃ±a para ver datos</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- AI Optimization Panel -->
        <div class="card glass hidden" id="optimizationPanel">
          <h3 class="card-title">ğŸ¤– Recomendaciones del Agente Media Buyer</h3>
          <div id="optimizationContent"></div>
        </div>
      </section>

    </main>
  </div>

  <!-- â”€â”€ Jarvi Chat Panel â”€â”€ -->
  <button id="chatToggle" class="chat-toggle-btn" title="Jarvi â€” Asistente IA">
    <span class="chat-toggle-icon">âœ¦</span>
  </button>

  <div id="chatPanel" class="chat-panel hidden">
    <div class="chat-header">
      <div class="chat-header-info">
        <span class="chat-header-title">âœ¦ Jarvi</span>
        <span class="chat-header-sub">Habla y modifica tu campaÃ±a</span>
      </div>
      <button id="chatClose" class="chat-close-btn">âœ•</button>
    </div>

    <div id="chatMessages" class="chat-messages">
      <div class="chat-msg assistant">
        Hola! Soy Jarvi. Puedo ayudarte a modificar conceptos, cambiar el targeting, ajustar el presupuesto o cualquier
        cosa de tu campaÃ±a. Â¿QuÃ© quieres cambiar?
      </div>
    </div>

    <div id="chatPendingActions" class="chat-pending-actions hidden"></div>

    <div class="chat-input-area">
      <textarea id="chatInput" class="chat-input" rows="2"
        placeholder="Ej: cambia el headline del concepto 2, sube el presupuesto a $20, selecciona los primeros 3..."></textarea>
      <button id="chatSend" class="btn btn-primary btn-sm chat-send-btn">Enviar</button>
    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>

</html>