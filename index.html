<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Andromeda Ads â€” Meta AI Automation</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&display=swap" rel="stylesheet" />
</head>
<body>
<div id="app">

  <!-- Sidebar -->
  <aside class="sidebar glass">
    <div class="logo">
      <span class="logo-icon">ğŸŒŒ</span>
      <div>
        <h1>Andromeda <span>Ads</span></h1>
        <p class="logo-sub">Meta AI Automation</p>
      </div>
    </div>

    <nav class="sidebar-nav">
      <button class="nav-btn active" data-view="setup">
        <span class="nav-icon">âš™ï¸</span>
        <span>ConfiguraciÃ³n</span>
        <span class="nav-badge" id="badgeSetup"></span>
      </button>
      <button class="nav-btn" data-view="briefing">
        <span class="nav-icon">ğŸ“‹</span>
        <span>Briefing de Marca</span>
        <span class="nav-badge" id="badgeBriefing"></span>
      </button>
      <button class="nav-btn" data-view="concepts">
        <span class="nav-icon">ğŸ’¡</span>
        <span>Conceptos y Creativos</span>
        <span class="nav-badge" id="badgeConcepts"></span>
      </button>
      <button class="nav-btn" data-view="campaign">
        <span class="nav-icon">ğŸš€</span>
        <span>Lanzar CampaÃ±a</span>
        <span class="nav-badge" id="badgeCampaign"></span>
      </button>
      <button class="nav-btn" data-view="dashboard">
        <span class="nav-icon">ğŸ“Š</span>
        <span>Dashboard</span>
        <span class="nav-badge" id="badgeDashboard"></span>
      </button>
    </nav>

    <div class="sidebar-footer">
      <div class="agent-status">
        <div class="agent-dot" id="agentDot"></div>
        <span id="agentLabel">Agentes listos</span>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="workspace">

    <!-- â”€â”€ VIEW: SETUP â”€â”€ -->
    <section id="viewSetup" class="view active">
      <div class="view-header">
        <h2>âš™ï¸ ConfiguraciÃ³n de Meta Ads</h2>
        <p class="view-sub">Conecta tu cuenta publicitaria de Meta para empezar a automatizar</p>
      </div>

      <!-- Shopify Brand Import Banner -->
      <div class="shopify-import-card glass" id="shopifyImportCard">
        <div class="shopify-import-left">
          <span class="shopify-icon">ğŸ›ï¸</span>
          <div>
            <strong>Importar marca desde Shopify</strong>
            <p>Conecta tu tienda y la IA leerÃ¡ tus productos, colecciones y copy para rellenar el briefing automÃ¡ticamente.</p>
          </div>
        </div>
        <div class="shopify-import-right">
          <input type="text"     id="shopifyShopUrl"   placeholder="tu-tienda.myshopify.com" />
          <input type="password" id="shopifyTokenInput" placeholder="shpat_xxxxxxxx" />
          <button class="btn btn-shopify" id="btnImportFromShopify">âœ¨ Analizar tienda con IA</button>
        </div>
        <div id="shopifyImportStatus" class="status-msg hidden" style="grid-column:1/-1"></div>
      </div>

      <div class="setup-grid">
        <!-- Credentials Card -->
        <div class="card glass">
          <h3 class="card-title">ğŸ”‘ Credenciales de Meta</h3>
          <div class="form-group">
            <label>Access Token (token de larga duraciÃ³n)</label>
            <input type="password" id="metaToken" placeholder="EAAxxxxxxxxx..." />
          </div>
          <div class="form-group">
            <label>Ad Account ID</label>
            <input type="text" id="metaAdAccount" placeholder="act_123456789" />
          </div>
          <div class="form-group">
            <label>Facebook Page ID</label>
            <input type="text" id="metaPageId" placeholder="123456789" />
          </div>
          <div class="form-group">
            <label>WhatsApp Number (opcional, con cÃ³digo de paÃ­s)</label>
            <input type="text" id="whatsappNumber" placeholder="+34600000000" />
          </div>
          <div id="metaStatus" class="status-msg hidden"></div>
          <button class="btn btn-primary" id="btnVerifyMeta">ğŸ”— Verificar ConexiÃ³n</button>
        </div>

        <!-- Setup Guide Card -->
        <div class="card glass">
          <h3 class="card-title">ğŸ“– GuÃ­a de ConfiguraciÃ³n</h3>
          <ol class="setup-steps">
            <li>
              <strong>Crea una Meta App</strong>
              <p>Ve a <a href="https://developers.facebook.com/apps/create" target="_blank" rel="noopener">developers.facebook.com</a> â†’ Crear App â†’ Tipo: <em>Business</em></p>
            </li>
            <li>
              <strong>AÃ±ade Marketing API</strong>
              <p>En tu app â†’ Productos â†’ AÃ±adir Marketing API</p>
            </li>
            <li>
              <strong>ObtÃ©n permisos</strong>
              <p>Necesitas: <code>ads_management</code>, <code>ads_read</code>, <code>pages_read_engagement</code></p>
            </li>
            <li>
              <strong>Genera tu Access Token</strong>
              <p><a href="https://developers.facebook.com/tools/explorer" target="_blank" rel="noopener">Graph API Explorer</a> â†’ selecciona tu app â†’ genera token de 60 dÃ­as</p>
            </li>
            <li>
              <strong>ObtÃ©n tu Ad Account ID</strong>
              <p><a href="https://business.facebook.com" target="_blank" rel="noopener">business.facebook.com</a> â†’ Cuentas â†’ Cuentas publicitarias â†’ copia <code>act_XXXXX</code></p>
            </li>
            <li>
              <strong>ObtÃ©n tu Page ID</strong>
              <p>Tu pÃ¡gina de Facebook â†’ Acerca de â†’ Transparencia de la pÃ¡gina â†’ ID de pÃ¡gina</p>
            </li>
          </ol>
        </div>
      </div>
    </section>

    <!-- â”€â”€ VIEW: BRIEFING â”€â”€ -->
    <section id="viewBriefing" class="view">
      <div class="view-header">
        <h2>ğŸ“‹ Briefing de Marca</h2>
        <p class="view-sub">Responde 5 preguntas para que los agentes IA entiendan tu marca y generen anuncios efectivos</p>
      </div>

      <div class="card glass briefing-card">
        <div class="briefing-form">
          <div class="form-group">
            <label>1. Â¿QuÃ© vendes exactamente? <span class="label-hint">(producto estrella, precio, materiales, colecciones)</span></label>
            <textarea id="b1" rows="3" placeholder="Ej: Ropa femenina de tallas grandes, colecciÃ³n primavera-verano 2025. Precio medio: 35â‚¬. Tejidos naturales y sostenibles..."></textarea>
          </div>
          <div class="form-group">
            <label>2. Â¿QuiÃ©n es tu cliente ideal? <span class="label-hint">(edad, gÃ©nero, estilo de vida, valores)</span></label>
            <textarea id="b2" rows="3" placeholder="Ej: Mujeres de 25-45 aÃ±os que valoran la moda sostenible, buscan looks modernos para el trabajo y el dÃ­a a dÃ­a..."></textarea>
          </div>
          <div class="form-group">
            <label>3. Â¿CuÃ¡l es el mayor problema que resuelves? <span class="label-hint">(dolor del cliente)</span></label>
            <textarea id="b3" rows="3" placeholder="Ej: Las mujeres de tallas grandes tienen dificultad para encontrar ropa estilosa que les quede bien y no sea cara..."></textarea>
          </div>
          <div class="form-group">
            <label>4. Â¿QuÃ© te diferencia de la competencia? <span class="label-hint">(propuesta de valor Ãºnica)</span></label>
            <textarea id="b4" rows="3" placeholder="Ej: DiseÃ±os exclusivos hechos en EspaÃ±a, tallas del 36 al 56, envÃ­o gratis en 24h, devoluciÃ³n gratuita..."></textarea>
          </div>
          <div class="form-group">
            <label>5. Â¿CuÃ¡l es el tono de tu marca? <span class="label-hint">(elige uno o describe)</span></label>
            <div class="tone-grid" id="toneGrid">
              <button class="tone-btn" data-tone="elegante y sofisticada">âœ¨ Elegante</button>
              <button class="tone-btn" data-tone="casual y cercana">ğŸ˜Š Casual</button>
              <button class="tone-btn" data-tone="atrevida y provocadora">ğŸ”¥ Atrevida</button>
              <button class="tone-btn" data-tone="minimalista y clean">ğŸ¤ Minimalista</button>
              <button class="tone-btn" data-tone="divertida y jovial">ğŸ‰ Divertida</button>
              <button class="tone-btn" data-tone="empoderada y feminista">ğŸ’ª Empoderada</button>
            </div>
            <input type="hidden" id="b5" value="" />
          </div>
        </div>
        <div id="briefingStatus" class="status-msg hidden"></div>
        <button class="btn btn-primary btn-lg" id="btnGenerateConcepts">âœ¨ Generar 10 Conceptos con IA</button>
      </div>
    </section>

    <!-- â”€â”€ VIEW: CONCEPTS â”€â”€ -->
    <section id="viewConcepts" class="view">
      <div class="view-header">
        <h2>ğŸ’¡ Conceptos y Creativos</h2>
        <p class="view-sub">Selecciona los conceptos que quieres incluir en tu campaÃ±a y genera sus creativos</p>
      </div>

      <div class="concepts-toolbar">
        <span id="conceptsSelectedCount" class="badge-count">0 seleccionados</span>
        <button class="btn btn-secondary btn-sm" id="btnSelectAllConcepts">âœ“ Todos</button>
        <button class="btn btn-primary" id="btnGoToCampaign" disabled>ğŸš€ Configurar CampaÃ±a â†’</button>
      </div>

      <div id="conceptsGrid" class="concepts-grid">
        <!-- Concept cards injected here -->
      </div>

      <!-- Image generation modal -->
      <div id="creativeModal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-box glass">
          <h3 id="modalTitle">Generar Creativo</h3>
          <div class="modal-tabs">
            <button class="modal-tab active" data-mode="generate">ğŸ¨ Generar desde cero</button>
            <button class="modal-tab" data-mode="edit">ğŸ“¸ Editar mi foto</button>
            <button class="modal-tab" data-mode="manual">ğŸ–¼ï¸ Usar mi imagen</button>
          </div>

          <div id="modeGenerate" class="modal-mode">
            <p class="mode-hint">La IA generarÃ¡ una imagen de moda segÃºn el concepto del anuncio</p>
            <div class="form-group">
              <label>Estilo visual adicional (opcional)</label>
              <input type="text" id="genStyle" placeholder="Ej: fondo blanco, modelo morena, luz natural..." />
            </div>
          </div>

          <div id="modeEdit" class="modal-mode hidden">
            <p class="mode-hint">Sube una foto de tu producto y la IA aÃ±adirÃ¡ texto y lo adaptarÃ¡ como anuncio</p>
            <div class="upload-area" id="photoUploadArea">
              <input type="file" id="photoFileInput" accept="image/*" class="hidden" />
              <span>ğŸ“ Arrastra o haz clic para subir foto</span>
            </div>
            <img id="photoPreview" class="photo-preview hidden" alt="preview" />
          </div>

          <div id="modeManual" class="modal-mode hidden">
            <p class="mode-hint">Usa tu propia imagen. Solo se generarÃ¡ el copy del anuncio.</p>
            <div class="upload-area" id="manualUploadArea">
              <input type="file" id="manualFileInput" accept="image/*" class="hidden" />
              <span>ğŸ“ Sube la imagen del anuncio</span>
            </div>
            <img id="manualPreview" class="photo-preview hidden" alt="preview" />
          </div>

          <div id="modalResult" class="modal-result hidden">
            <img id="generatedCreative" alt="Creative" />
            <a id="btnDownloadCreative" class="btn btn-secondary btn-sm" download="creative.png">â¬‡ Descargar</a>
          </div>

          <div id="modalStatus" class="status-msg hidden"></div>
          <div class="modal-actions">
            <button class="btn btn-primary" id="btnGenerateCreative">ğŸ¨ Generar</button>
            <button class="btn btn-ghost" id="btnCloseModal">Cerrar</button>
          </div>
        </div>
      </div>
    </section>

    <!-- â”€â”€ VIEW: CAMPAIGN â”€â”€ -->
    <section id="viewCampaign" class="view">
      <div class="view-header">
        <h2>ğŸš€ Configurar y Lanzar CampaÃ±a</h2>
        <p class="view-sub">Configura el presupuesto, la audiencia y lanza la campaÃ±a de microexperimentaciÃ³n</p>
      </div>

      <div class="campaign-grid">
        <!-- Campaign Settings -->
        <div class="card glass">
          <h3 class="card-title">ğŸ“Œ ConfiguraciÃ³n de CampaÃ±a</h3>
          <div class="form-group">
            <label>Nombre de campaÃ±a</label>
            <input type="text" id="campaignName" placeholder="Andromeda_Moda_Ene2025" />
          </div>
          <div class="form-group">
            <label>Objetivo</label>
            <select id="campaignObjective">
              <option value="OUTCOME_SALES">Maximizar Conversiones (Ventas)</option>
              <option value="OUTCOME_LEADS">Conversaciones WhatsApp</option>
              <option value="OUTCOME_TRAFFIC">TrÃ¡fico al sitio web</option>
            </select>
          </div>
          <div class="form-group">
            <label>Presupuesto diario por ad set</label>
            <div class="input-prefix">
              <span>$</span>
              <input type="number" id="dailyBudget" value="5" min="1" step="1" />
            </div>
            <span class="input-hint" id="budgetHint">$5/dÃ­a Ã— 7 dÃ­as = $35 total por concepto</span>
          </div>
          <div class="form-group">
            <label>DuraciÃ³n (dÃ­as)</label>
            <input type="number" id="campaignDuration" value="7" min="1" max="30" />
          </div>
          <div class="form-group">
            <label>URL de destino (landing page o WhatsApp)</label>
            <input type="text" id="destinationUrl" placeholder="https://wa.me/34600000000?text=Hola!" />
          </div>
        </div>

        <!-- Audience Settings -->
        <div class="card glass">
          <h3 class="card-title">ğŸ¯ Audiencia</h3>
          <div class="form-group">
            <label>PaÃ­s(es)</label>
            <input type="text" id="targetCountries" value="ES" placeholder="ES, MX, AR..." />
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Edad mÃ­nima</label>
              <input type="number" id="ageMin" value="18" min="18" max="65" />
            </div>
            <div class="form-group">
              <label>Edad mÃ¡xima</label>
              <input type="number" id="ageMax" value="45" min="18" max="65" />
            </div>
          </div>
          <div class="form-group">
            <label>GÃ©nero</label>
            <select id="targetGender">
              <option value="all">Todos</option>
              <option value="1" selected>Hombres</option>
              <option value="2">Mujeres</option>
            </select>
          </div>
          <div class="form-group">
            <label>Intereses (separados por coma)</label>
            <input type="text" id="targetInterests" value="Moda, Ropa, Compras online, Instagram Fashion" />
          </div>
        </div>
      </div>

      <!-- Selected concepts summary -->
      <div class="card glass" id="selectedConceptsSummary">
        <h3 class="card-title">ğŸ’¡ Conceptos seleccionados (<span id="selectedCount">0</span>)</h3>
        <div id="selectedConceptsList" class="selected-list"></div>
      </div>

      <div id="campaignStatus" class="status-msg hidden"></div>
      <button class="btn btn-primary btn-lg btn-launch" id="btnLaunchCampaign">ğŸš€ Lanzar CampaÃ±a Ahora</button>
    </section>

    <!-- â”€â”€ VIEW: DASHBOARD â”€â”€ -->
    <section id="viewDashboard" class="view">
      <div class="view-header">
        <h2>ğŸ“Š Dashboard de Rendimiento</h2>
        <p class="view-sub">Seguimiento en tiempo real y optimizaciÃ³n automÃ¡tica con IA</p>
      </div>

      <!-- Campaign selector -->
      <div class="dashboard-toolbar">
        <select id="campaignSelector">
          <option value="">Selecciona una campaÃ±a...</option>
        </select>
        <button class="btn btn-secondary btn-sm" id="btnRefreshStats">â†º Actualizar</button>
        <button class="btn btn-primary" id="btnAnalyzeAI">ğŸ¤– Analizar con IA</button>
        <button class="btn btn-warning hidden" id="btnApplyOptimizations">âš¡ Aplicar Recomendaciones</button>
      </div>

      <!-- KPI Cards -->
      <div class="kpi-grid" id="kpiGrid">
        <div class="kpi-card glass">
          <span class="kpi-label">Gasto Total</span>
          <span class="kpi-value" id="kpiSpend">â€”</span>
        </div>
        <div class="kpi-card glass">
          <span class="kpi-label">Impresiones</span>
          <span class="kpi-value" id="kpiImpressions">â€”</span>
        </div>
        <div class="kpi-card glass">
          <span class="kpi-label">Clics</span>
          <span class="kpi-value" id="kpiClicks">â€”</span>
        </div>
        <div class="kpi-card glass">
          <span class="kpi-label">CTR</span>
          <span class="kpi-value" id="kpiCtr">â€”</span>
        </div>
        <div class="kpi-card glass">
          <span class="kpi-label">CPM</span>
          <span class="kpi-value" id="kpiCpm">â€”</span>
        </div>
        <div class="kpi-card glass">
          <span class="kpi-label">Conversiones</span>
          <span class="kpi-value" id="kpiConversions">â€”</span>
        </div>
      </div>

      <!-- Ads performance table -->
      <div class="card glass">
        <h3 class="card-title">ğŸ“‹ Rendimiento por Anuncio</h3>
        <div class="table-wrap">
          <table id="adsTable">
            <thead>
              <tr>
                <th>Anuncio / Concepto</th>
                <th>Gasto</th>
                <th>Impresiones</th>
                <th>CTR</th>
                <th>CPM</th>
                <th>Conversiones</th>
                <th>ROAS</th>
                <th>Estado IA</th>
              </tr>
            </thead>
            <tbody id="adsTableBody">
              <tr><td colspan="8" class="table-empty">Selecciona una campaÃ±a para ver datos</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- AI Optimization Panel -->
      <div class="card glass hidden" id="optimizationPanel">
        <h3 class="card-title">ğŸ¤– Recomendaciones del Agente Media Buyer</h3>
        <div id="optimizationContent"></div>
      </div>
    </section>

  </main>
</div>

<script type="module" src="app.js"></script>
</body>
</html>
